#!/system/bin/sh

# Definisi Variabel
SERVICE_DIR="/data/adb/service.d"
SERVICE_FILE="$SERVICE_DIR/modpes_service.sh"
SCRIPT_PATH="/data/adb/php8/scripts/airplane/modpes"

case "$1" in
  enable)
    # Cek apakah folder service ada, jika tidak buat (untuk jaga-jaga)
    if [ ! -d "$SERVICE_DIR" ]; then
      mkdir -p "$SERVICE_DIR"
    fi

    # Buat file service
    cat <<EOF > "$SERVICE_FILE"
#!/system/bin/sh
# Generated by system
sleep 5
$SCRIPT_PATH start > /dev/null 2>&1 &
EOF
    
    # Beri izin eksekusi
    chmod 0755 "$SERVICE_FILE"
    echo "Boot service enabled"
    ;;

  disable)
    # Hapus file service jika ada
    if [ -f "$SERVICE_FILE" ]; then
      rm -f "$SERVICE_FILE"
      echo "Boot service disabled"
    else
      echo "Service file not found"
    fi
    ;;

  status)
    # Cek status untuk PHP (0 = tidak aktif, 1 = aktif)
    if [ -f "$SERVICE_FILE" ]; then
      echo "1"
    else
      echo "0"
    fi
    ;;
esac
